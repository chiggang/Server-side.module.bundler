!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t){e.exports=require("fs-extra")},function(e,t,o){"use strict";var n=p(o(2)),r=p(o(0)),a=p(o(3)),i=p(o(4)),c=p(o(5)),s=p(o(6)),u=p(o(7)),l=p(o(8)),f=p(o(12)),d=p(o(13)),g=p(o(14));function p(e){return e&&e.__esModule?e:{default:e}}var m={server:{},database:{}};try{m.server=g.default.readConfigFile(n.default.join(__dirname,"json/server.config.json")),m.database=g.default.readConfigFile(n.default.join(__dirname,"json/database.config.json")),g.default.readConfigFile(n.default.join(__dirname,"json/query.json")),g.default.setLog(!0,"Configuration: 환경설정을 불러왔습니다.",!0)}catch(e){g.default.setLog(!0,"Configuration: 환경설정을 불러올 수 없습니다.",!0)}var y=(0,a.default)();y.use(c.default.json()),y.use(c.default.urlencoded({extended:!0})),y.use((0,f.default)()),y.use(function(e,t,o,n){o.end(JSON.stringify({status:400,result:"error",message:"JSON 형식에 오류가 있거나 서버 오류일 수 있습니다.",data:null}))}),y.use((0,i.default)({allowedHeaders:["sessionId","Content-Type"],exposedHeaders:["sessionId"],origin:"*",methods:"GET,HEAD,PUT,PATCH,POST,DELETE",preflightContinue:!1}));(0,d.default)(y,function(e){});var v=y.listen(m.server.socket.port,function(e){if(e)return g.default.setLog(!0,"Error | Socket: 소켓 서버를 시작할 수 없습니다.",!1),void g.default.setLog(!0,"Error | Socket: ".concat(e.stack),!0);g.default.setLog(!0,"Socket: 소켓 서버를 시작하였습니다.",!1),g.default.setLog(!0,"Socket: ".concat(m.server.socket.url,":").concat(m.server.socket.port),!0)}),S=y.listen(m.server.uploaderSocket.port,function(e){if(e)return g.default.setLog(!0,"Error | Socket: 업로드 소켓 서버를 시작할 수 없습니다.",!1),void g.default.setLog(!0,"Error | Socket: ".concat(e.stack),!0);g.default.setLog(!0,"Socket: 업로드 소켓 서버를 시작하였습니다.",!1),g.default.setLog(!0,"Socket: ".concat(m.server.uploaderSocket.url,":").concat(m.server.uploaderSocket.port),!0)}),h=(0,s.default)(v);h.on("connection",function(e){g.default.setLog(!0,"User: 사용자(".concat(e.id,")가 접속하였습니다."),!1),e.on("getPathInfo",function(t){var o=g.default.getPathInfo(t.path,null);h.to(e.id).emit("pathInfo",o)}),e.on("copyTargetFile",function(t){var o="".concat((new Date).getTime(),"-").concat((0,l.default)()),n="".concat(m.server.transmission.downloadDir,"/").concat(o);r.default.copy("".concat(t.path,"/").concat(t.fileName),"".concat(n),function(r){if(r)return g.default.setLog(!0,"Error | Download: 임시 디렉토리로 파일을 복사할 수 없습니다.",!1),void g.default.setLog(!0,"Error | Download: ".concat(r),!0);h.to(e.id).emit("downloadPath",{fileName:t.fileName,newFileName:o,downloadPath:n})})}),e.on("removeTargetFile",function(e){r.default.unlink(e.downloadPath)}),e.on("createDirectory",function(t){var o="".concat(t.path,"/").concat(t.newDirectory);if(r.default.existsSync(o))h.to(e.id).emit("message",{code:"createDirectory_exist"});else{r.default.ensureDirSync(o,{mode:1533});var n=g.default.getPathInfo(t.path,null);h.to(e.id).emit("pathInfo",n),h.to(e.id).emit("message",{code:"createDirectory_ok",newDirectory:t.newDirectory})}})}),(0,s.default)(S).on("connection",function(e){g.default.setLog(!0,"UploaderUser: 사용자(".concat(e.id,")가 접속하였습니다."),!1);var t=new u.default(e,{uploadDir:m.server.transmission.uploadDir,maxFileSize:m.server.transmission.maxFileSize,chunkSize:m.server.transmission.chunkSize,transmissionDelay:m.server.transmission.transmissionDelay,overwrite:m.server.transmission.overwrite});t.on("start",function(t){g.default.setLog(!0,"File: 파일 전송을 시작합니다.",!1),g.default.setLog(!0,"File: ".concat(e.id," / ").concat(t.size," bytes / ").concat(t.name),!0)}),t.on("stream",function(e){}),t.on("complete",function(t){g.default.setLog(!0,"File: 파일 전송이 완료되었습니다.",!1),g.default.setLog(!0,"File: ".concat(e.id," / ").concat(t.size," bytes / ").concat(t.name),!0);var o=g.default.getPathInfo("../Download",null);h.to(e.id).emit("pathInfo",o)}),t.on("error",function(t){g.default.setLog(!0,"File: 파일 전송에 오류가 발생하였습니다.",!1),g.default.setLog(!0,"File: ".concat(e.id," / ").concat(fileInfo.size," bytes / ").concat(fileInfo.name),!1),g.default.setLog(!0,t,!0)}),t.on("abort",function(t){g.default.setLog(!0,"File: 파일 전송이 취소되었습니다.",!1),g.default.setLog(!0,"File: ".concat(e.id," / ").concat(t.size," bytes / ").concat(t.name),!0)})})},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("socket.io")},function(e,t){e.exports=require("socket.io-file")},function(e,t,o){var n=o(9),r=o(11);e.exports=function(e,t,o){var a=t&&o||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var c=0;c<16;++c)t[a+c]=i[c];return t||r(i)}},function(e,t,o){var n=o(10);e.exports=function(){return n.randomBytes(16)}},function(e,t){e.exports=require("crypto")},function(e,t){for(var o=[],n=0;n<256;++n)o[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,r=o;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}},function(e,t){e.exports=require("compression")},function(e,t,o){"use strict";var n,r=(n=o(0))&&n.__esModule?n:{default:n};e.exports=function(e,t){e.post("/api/set/create_directory",function(e,t){try{var n=e.body.params,a="".concat(n.path,"/").concat(n.newDirectoryName);r.default.existsSync(a)?o(t,!1,null):(r.default.ensureDirSync(a,{mode:1533}),o(t,!0,null))}catch(e){console.log(e)}});var o=function(e,t,o){try{return t?e.end(JSON.stringify({status:200,result:"success",message:"실행하였습니다.",data:o})):e.end(JSON.stringify({status:500,result:"fail",message:"실행에 실패하였습니다.",data:o}))}catch(e){console.log(e)}}}},function(e,t,o){"use strict";var n,r=(n=o(15))&&n.__esModule?n:{default:n};e.exports={setLog:function(e,t,o){var n="";e&&(n=a(new Date)),console.log("".concat(n," | ").concat(t)),o&&console.log("")},getDateText:function(e){a(e)},readConfigFile:function(e){try{var t=r.default.readFileSync(e,"utf8");return JSON.parse(t)}catch(e){return console.log("서버 JSON 파일 읽기에 실패하였습니다."),console.log(e),null}},getPathInfo:function(e,t){var o=[],n=[];try{r.default.readdirSync(e,{withFileTypes:!0}).map(function(i){var c=r.default.statSync("".concat(e,"/").concat(i.name)),s={type:i.isDirectory()?"directory":"file",name:i.name,size:c.size,createDatetime:a(c.ctime),modifyDatetime:a(c.mtime),accessDatetime:a(c.atime)};switch(i.isDirectory()){case!0:t&&"d"!==t||o.push(s);break;case!1:t&&"f"!==t||n.push(s)}})}catch(e){console.log(e)}return{directory:o,file:n}}};var a=function(e){return i(e.getFullYear(),4)+"."+i(e.getMonth()+1,2)+"."+i(e.getDate(),2)+" "+i(e.getHours(),2)+":"+i(e.getMinutes(),2)+":"+i(e.getSeconds(),2)},i=function(e,t){var o="";if((e=e.toString()).length<t)for(var n=0;n<t-e.length;n++)o+="0";return o+e}},function(e,t){e.exports=require("fs")}]);